##
## aluno: Micael Levi L. C. - 21554923
## versão: 25-05-2021
##

################################################################################
## 1
################################################################################
A = matrix(c(0,1,3, 1,2,1, 1,1,4), nrow=3, byrow=TRUE)
B = matrix(c(0,1,2, 0,4,2, 7,0,1), nrow=3, byrow=TRUE)

## -------------------------------------------------------------------------- ##
## Resposta da 1A
## -------------------------------------------------------------------------- ##
r_1a = A %*% A - t(B) - (A + B) %*% (A - B)
#       [,1] [,2] [,3]
# [1,]    0    1   -3
# [2,]   -1   12    4
# [3,]   47   -2    0

## -------------------------------------------------------------------------- ##
## Resposta da 1B
## -------------------------------------------------------------------------- ##
r_1b = solve(A) %*% B + B %*% solve(A)
#           [,1]       [,2]       [,3]
# [1,]  6.666667 -0.3333333 -1.3333333
# [2,] -1.166667  4.1666667 -0.1666667
# [3,] -6.833333  0.5000000  6.1666667

## -------------------------------------------------------------------------- ##
## Resposta da 1C
## -------------------------------------------------------------------------- ##
r_1c = det(A) * A + t( det(B) * A )
#      [,1] [,2] [,3]
# [1,]    0  -48  -60
# [2,]  -48  -96  -48
# [3,] -132  -48 -192

################################################################################
## 2
################################################################################
X = c(seq(from=1,to=10), seq(11,1))
Z = rep(seq(1,6), times=seq(6,1))

## -------------------------------------------------------------------------- ##
## Resposta da 2A
## -------------------------------------------------------------------------- ##
y = X * Z
r_2a = (X/Z) * Z - sqrt(Z) * t(X) * y
#      [,1] [,2] [,3] [,4] [,5] [,6]      [,7]      [,8]      [,9]     [,10]     [,11]     [,12]     [,13]
# [1,]    0   -2   -6  -12  -20  -30 -131.5929 -173.0193 -220.1026 -272.8427 -331.2397 -509.6152 -411.8883
#          [,14]     [,15] [,16] [,17] [,18]     [,19]     [,20]     [,21]
# [1,] -324.5538 -247.6115  -282  -195  -124 -97.62306 -42.72136 -13.69694

## -------------------------------------------------------------------------- ##
## Resposta da 2B
## -------------------------------------------------------------------------- ##
r_2b = X %*% t(Z) - y
#       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21]
#  [1,]    0    0    0    0    0    0    1    1    1     1     1     2     2     2     2     3     3     3     4     4     5
#  [2,]    0    0    0    0    0    0    2    2    2     2     2     4     4     4     4     6     6     6     8     8    10
#  [3,]    0    0    0    0    0    0    3    3    3     3     3     6     6     6     6     9     9     9    12    12    15
#  [4,]    0    0    0    0    0    0    4    4    4     4     4     8     8     8     8    12    12    12    16    16    20
#  [5,]    0    0    0    0    0    0    5    5    5     5     5    10    10    10    10    15    15    15    20    20    25
#  [6,]    0    0    0    0    0    0    6    6    6     6     6    12    12    12    12    18    18    18    24    24    30
#  [7,]   -7   -7   -7   -7   -7   -7    0    0    0     0     0     7     7     7     7    14    14    14    21    21    28
#  [8,]   -8   -8   -8   -8   -8   -8    0    0    0     0     0     8     8     8     8    16    16    16    24    24    32
#  [9,]   -9   -9   -9   -9   -9   -9    0    0    0     0     0     9     9     9     9    18    18    18    27    27    36
# [10,]  -10  -10  -10  -10  -10  -10    0    0    0     0     0    10    10    10    10    20    20    20    30    30    40
# [11,]  -11  -11  -11  -11  -11  -11    0    0    0     0     0    11    11    11    11    22    22    22    33    33    44
# [12,]  -20  -20  -20  -20  -20  -20  -10  -10  -10   -10   -10     0     0     0     0    10    10    10    20    20    30
# [13,]  -18  -18  -18  -18  -18  -18   -9   -9   -9    -9    -9     0     0     0     0     9     9     9    18    18    27
# [14,]  -16  -16  -16  -16  -16  -16   -8   -8   -8    -8    -8     0     0     0     0     8     8     8    16    16    24
# [15,]  -14  -14  -14  -14  -14  -14   -7   -7   -7    -7    -7     0     0     0     0     7     7     7    14    14    21
# [16,]  -18  -18  -18  -18  -18  -18  -12  -12  -12   -12   -12    -6    -6    -6    -6     0     0     0     6     6    12
# [17,]  -15  -15  -15  -15  -15  -15  -10  -10  -10   -10   -10    -5    -5    -5    -5     0     0     0     5     5    10
# [18,]  -12  -12  -12  -12  -12  -12   -8   -8   -8    -8    -8    -4    -4    -4    -4     0     0     0     4     4     8
# [19,]  -12  -12  -12  -12  -12  -12   -9   -9   -9    -9    -9    -6    -6    -6    -6    -3    -3    -3     0     0     3
# [20,]   -8   -8   -8   -8   -8   -8   -6   -6   -6    -6    -6    -4    -4    -4    -4    -2    -2    -2     0     0     2
# [21,]   -5   -5   -5   -5   -5   -5   -4   -4   -4    -4    -4    -3    -3    -3    -3    -2    -2    -2    -1    -1     0

## -------------------------------------------------------------------------- ##
## Resposta da 2C
## -------------------------------------------------------------------------- ##
r_2c_1 = X[(X %% 2 == 0)]
# [1]  2  4  6  8 10 10  8  6  4  2
r_2c_2 = Z[(Z %% 2 == 0)]
# [1] 2 2 2 2 2 4 4 4 6

## -------------------------------------------------------------------------- ##
## Resposta da 2D
## -------------------------------------------------------------------------- ##
sum(X)
sum(Z)
min(X)
min(Z)
sqrt(X)
sqrt(Z)
mean(X)
mean(Z)

################################################################################
## 3
################################################################################

q3 = data.frame(
  c("M","M","M","M","M","F","F","F","F","F"),
  c("Fundamental", "Médio", "Superior", "Superior", "Superior", "Médio", "Superior", "Superior", "Superior", "Superior"),
  c(1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 10000)
)
colnames(q3) = c("sexo", "nivel escolar", "renda mensal")

## -------------------------------------------------------------------------- ##
## Respostas da 3
## -------------------------------------------------------------------------- ##

q3_a = apply( q3[q3$`nivel escolar` == "Fundamental", ]["renda mensal"], 2, median )
q3_b = apply( q3[q3$sexo == "F", ]["renda mensal"], 2, median )
q3_c = apply( q3[q3$sexo == "M", ]["renda mensal"], 2, median )
q3_d = apply( q3[q3$sexo == "F" & q3$`nivel escolar` == "Superior", ]["renda mensal"], 2, median )
q3_e = apply( q3[q3$sexo == "M" & q3$`nivel escolar` == "Superior", ]["renda mensal"], 2, median )

################################################################################
## 4
################################################################################

## -------------------------------------------------------------------------- ##
## Respostas da 4
## -------------------------------------------------------------------------- ##

q4=data.frame(
  stringsAsFactors=FALSE,
  c( NA,  0,  1,  2),
  c(0,  0.1, 0.08,  0.1),
  c(1, 0.05, 0.05,  0.2),
  c(2, 0.02,  0.1, 0.04),
  c(3, 0.07, 0.19,    0)
)
q4["P.y",-1] =colSums(q4[,-1], na.rm =T)
q4[-1, "P.x"] = rowSums(q4[-1,], na.rm = T)

## melhorando a visualização do dataframe
q4[is.na(q4)]=""
q4[1,] = c("", "0", "1", "2", "3", "")
q4[,1] = c("", "0", "1", "2", "P(Y=yj)")
colnames(q4) = c("X","Y1", "Y2", "Y3", "Y4", "P(X=xi)")
View(q4)
#           X   Y1   Y2   Y3   Y4 P(X=xi)
# 1              0    1    2    3
# 2         0  0.1 0.05 0.02 0.07    0.24
# 3         1 0.08 0.05  0.1 0.19    1.42
# 4         2  0.1  0.2 0.04    0    2.34
# P.y P(Y=yj) 0.28  1.3 2.16 3.26       7
